---
title: Relational
---

# Relational

## Contents

  - Primary Key
  - Foreign Key
  - Cardinality

ความสัมพันธ์ ถือเป็นหัวใจสำคัญของ Relational Database เพราะเมื่อเก็บข้อมูลกันจริงๆ Relational Database จะแยกเก็บข้อมูลแต่ละอย่างออกจากกัน คือแยก table ออกจากกันเป็นเรื่องๆ เช่น คน, ประเทศ จะถูกจัดเก็บกันคนละ table ทั้งนี้เพื่อลดความซ้ำซ้อนของการจัดเก็บข้อมูลนั่นเอง

เทคนิกในการแยกประเภทข้อมูลเพื่อไม่ให้เกิดความซ้ำซ้อนใน Relational Database เรียกว่า Normalization แบ่งออกเป็น 5 ระดับ (1NF - 5NF) ในทางปฏิบัติเราใช้เทคนิกนี้เพียง 1NF - 3NF ก็พอสำหรับ application ทั่วๆ ไป

เรื่อง Normalization ถือเป็นเรื่องสำคัญที่เราต้องรู้ ถ้าหากเราต้องการเขียน app ขึ้นมาจริงๆ ซักตัว แต่เราจะว่ากันในหัวข้อถัดไปนะครับ

เอาล่ะครับ เมื่อข้อมูลไม่ซ้ำซ้อนกัน การอัปเดทข้อมูลของเราก็จะง่ายตามไปด้วย ลองนึกภาพว่า เรามีข้อมูลคน 100 คนใน 10 ประเทศ แปลว่าทุกๆ 10 คน จะเป็นคนประเทศเดียวกัน

ถ้าหากเราเก็บข้อมูลทั้งหมดไว้ใน table เดียวกัน และถ้าเขียนชื่อประเทศผิดซักประเทศ เราอาจต้องตามแก้ข้อมูลถึง 10 rows ก็เป็นได้

---- TODO: insert data sample

ทางออกคือแยกเก็บคน และเก็บประเทศออกจากกัน และทำการ link เข้าหากันด้วย key ตามวิธีของ Normalization

---- TODO: insert data sample

ถึงตรงนี้ มีสิ่งที่เราต้องเรียนรู้เพิ่มอีก 3 อย่าง เพื่อใช้ออกแบบ database ของเราให้มีความสัมพันธ์กัน

## 1. Primary Key
คือ ค่าของข้อมูลใน column ที่ใช้กำหนดความเป็นหนึ่งเดียว (uniquely) ของแต่ละแถวข้อมูล คล้ายกับหมายเลขบัตรประชาชน ที่แต่ละคนจะมีไม่ซ้ำกัน

Primary Key อาจเป็นค่าของ column เดียว หรือหลาย column รวมกัน ก็ได้ และถ้ามันมาจากหลาย column รวมกัน เราจะเรียกมันว่า `Composite Key` หรือคีย์ร่วม

--- TODO: insert data sample

Composite Key คือการใช้ค่าของหลาย column รวมกัน เพื่อให้เกิดความเป็นหนึ่งเดียว (uniquely) ของแถวข้อมูล เช่น หากเราไม่ใช้บัตรประชาชนเป็นตัวกำหนดความเป็นหนึ่งเดียวของคน เราอาจใช้ ชื่อ และนามสกุล เป็นตัวกำหนดก็ได้ (แต่ในความเป็นจริงชื่อและนามสกุลอาจซ้ำกันได้)

--- TODO: insert data sample

ในระบบสมัยใหม่ ไม่นิยมใช้ Composite Key เพื่อเป็นตัวแทนของข้อมูลจำเพาะมากนัก โดยส่วนมากจะใช้เพื่อเชื่อมเข้ามูลใน direction ที่เรียก่า many-to-many 

Primary Key นิยมใช้ ตัวเลขลำดับ 1-n เป็นส่วนมาก เนื่องจากมีความสะดวก และไม่จำเป็นต้องเป็นที่จดจำของคน แต่หากเราต้องการ Key ที่มีความหมายและง่ายสำหรับการจดจำ หรือในทางกลับกันคือ ยากสำหรับการคาดเดา เราก็อาจสร้างชุดรหัสที่ไม่ซ้ำกันมาเป็น primary key แทนก็ได้

## 2. Foreign Key
Foreign Key ก็คือ Primary Key ที่ถูกใช้ในการอ้างอิงถึงแถวข้อมูล (row) ในต่าง table เมื่อเราทำการ link หรือทำความสัมพันธ์ของข้อมูล

--- TODO: insert data sample

## 3. Cardinality
Cardinality คือลักษณะเฉพาะของสัมพันธ์ในระบบ RDB ส่วนนี้สำคัญมากในการทำความเข้าใจวิธีคิดของ  Doctrine เราจะได้เรียนรู้ Direction ต่างๆ ของสัมพันธ์ของข้อมูลตลอดทั้งเล่มของหนังสือนี้

อย่างที่เราทราบ RDB ใช้ระบบ Key เป็นตัวอ้างอิงเพื่อสร้างความสัมพันธ์ของข้อมูลในรูปแบบต่างๆ Primary Key ใช้เป็นตัวแทนของแต่ละ Row และเมื่อมันถูกใช้เป็นตัวอ้างอิงใน table อื่น เราจะเรียกมันว่า Foreign Key โดยพื้นฐานแล้วลักษณะความสัมพันธ์ใน RDB แบ่งออกเป็น 3(+1) แบบคือ

##### ***One-to-One** ความสัมพันธ์แบบ หนึ่งต่อหนึ่ง (1:1)*
![enter image description here](https://i.imgur.com/K24nHV0.png)
ความสัมพันธ์ของข้อมูลแบบหนึ่งต่อหนึ่ง เช่น **"ประเทศ 1 ประเทศ มีเมืองหลวงเพียงแห่งเดียว ในทางกลับกัน เมืองหลวง 1 เมือง ก็เป็นของประเทศได้เพียงประเทศเดียว"**

ในทางปฏิบัติสถานการณ์ที่เข้าลักษณะ one-to-one แบบสมจริงนั้นมีไม่มากนัก แต่ one-to-one ก็มีประโยชน์ในลักษณะของการใช้เชื่อมข้อมูลที่เป็นตัวเลือก (Optional) ของระบบ หรือการเพิ่มคุณสมบัติของระบบในภายหลัง (อาจถอดเข้าถอดออกได้) เช่น การเก็บข้อมูลเฉพาะด้านของพนักงานแต่ละคน เราอาจไม่ต้องรวมทุกอย่างไว้ในตารางของ "พนักงาน - employee" ก็ได้ เราสามารถแยกกลุ่มข้อมูลออกเป็นส่วนๆ และเชื่อมความสัมพันธ์กันแบบ one-to-one เช่น ข้อมูลสุขภาพ (employee-medical), ข้อมูลภูมิลำนำ (employee-local) เป็นต้น

##### ***One-to-Many** หรือ หนึ่งต่อมาก (1:n) ....*
##### ***Many-to-Many** หรือ มากต่อมาก (n:n)*
![enter image description here](https://i.imgur.com/NVux8Bf.png)

![enter image description here](https://i.imgur.com/0l5YFkP.jpg)

##### ***Many-to-One** หรือ มากต่อหนึ่ง (n:1) ....* inverse of 1:n

